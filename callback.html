<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    ​
  </head>

  <body style="background-color: #b5a55c; padding-top: 30%">
    <center>
      <!-- <h1>Thank you!</h1> -->
      <div>
        <!-- <img src="../pp.jpeg" height="200px" width="200px" /> -->
      </div>
      <p id="text"></p>
    </center>
    <script>
      var myHeaders = new Headers();
      myHeaders["Content-Type"] = "application/json";
      myHeaders["Access-Control-Allow-Origin"] = "*";
      myHeaders["Origin"] = "app.yellowmessenger.com";
      myHeaders["authority"] = "app.yellowmessenger.com";
      myHeaders["Cookie"] =
        "__cfduid=d2a7454f6dfb24a5754f025737613dd9c1611311191";

      // myHeaders.append("Content-Type", "application/json");
      // myHeaders.append("Access-Control-Allow-Origin", "*");
      // myHeaders.append("Access-Control-Allow-Origin", null);
      // myHeaders.append("origin", "app.yellowmessenger.com");
      // myHeaders.append("authority", "app.yellowmessenger.com");
      // 'origin': 'https://app.yellowmessenger.com',
      // 'authority': 'app.yellowmessenger.com'
      // myHeaders.append(
      //   "Cookie",
      //   "__cfduid=d2a7454f6dfb24a5754f025737613dd9c1611311191"
      // );

      let custid = new URLSearchParams(window.location.search).get("CustId");
      let refno = new URLSearchParams(window.location.search).get(
        "PaymentRefNo"
      );
      let status = new URLSearchParams(window.location.search).get(
        "PaymentStatus"
      );
      let msg = new URLSearchParams(window.location.search).get("PaymentMsg");

      let data = {
        customerId: custid,
        referenceNo: refno,
        paymentStatus: status,
        paymentMsg: msg,
      };

      var raw = JSON.stringify({
        authToken: "a9c98441da95bda8b7a6938bdc72",
        from: "wealth",
        params: data,
      });

      var requestOptions = {
        method: "POST",
        headers: myHeaders,
        body: raw,
        redirect: "follow",
      };

      let finalMsg;
      if (status.toLowerCase().includes("success")) {
        finalMsg = `Thank you! Your payment is successful. Ref No: <strong>${refno}</strong>`;
      } else {
        finalMsg = `There was a payment failure. Please try again later`;
      }
      // alert(finalMsg);
      console.log(requestOptions.headers, "HEADER");
      console.log(myHeaders, "myHEADER");
      document.getElementById("text").innerHTML = finalMsg;
      fetch(
        "https://app.yellowmessenger.com/integrations/sendevent/tatacapital/x1627624404295",
        requestOptions
      )
        .then((response) => response.text())
        .then((result) => console.log(result))
        .catch((error) => console.log("error", error));
    </script>
    ​
  </body>
</html>
